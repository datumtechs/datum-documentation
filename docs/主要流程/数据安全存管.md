# 数据安全存管


数据从web2进入web3的起点，是能够被合理的采集和传输到web3能够触达的环境中。Datum将提供一系列服务API，使用户能以合适的方式采集并传输数据。Datum将作为服务商为用户解决数据安全存管环节的各类解决方案，包括：数据对接、数据上传、数据存储管理。并作为可信任的托管服务商，使得用户能够方便的实现web3模式下的数据资产化、数据检索、数据使用服务。用户拥有对数据的完全掌控，可以按需选择适用的API。
  
## 支持的传输模式

- 云服务传输，数据集中托管
- IPFS传输，数据分布式管理
- 区块链传输，数据共识管理



### 云服务传输

Datum提供多种云服务资源，用户可注册选择员云服务环境，并上传原始数据。数据传输完成后，用户就能通过Datum提供的后续服务，轻松将数据接入Web3生态。



#### 如何使用


- 接口名称：`uploadData`

- 请求方式: `POST`

- 请求数据类型: `multipart/form-data`

- 响应数据类型: `*/*`


- 请求参数：


|名称|类型|说明|是否必填|
|---|---|---|---|
|file|string|文件|Y| 
|storageType|int|存储方式(0： 本地存储； <span style="color: red; font-weight: bold;">1： 云存储【本接口填1】；</span> 2： IPFS存储； 3： 区块链存储)|Y|
|storageOption|string|json格式的字符串表示存储方式的选项，和storageType搭配使用[查看](#storageOption值说明)|Y|


- 响应状态:


|状态码| 说明 |
|---|---|
|200|OK|
|201|Created|
|401|Unauthorized|
|403|Forbidden|
|404|Not Found|


- 响应参数:


|名称|类型|说明|是否必填|
|---|---|---|---|
|status|int|响应码|Y|
|result|json|上传后的摘要信息|Y|
|originId|string|上传后的原始数据的originId,代表该原始数据在Datum中的唯一标识|Y|
|hash|string|上传后的原始数据内容Hash|Y|
|msg|string|响应描述|Y|



- 响应示例:

  ```json
  {
      "status": 200,
      "result": {
        "originId": "0xdadad...454545",
        "hash": "295e5ae656d084dfda86c4ef7c38719ee1fb650899ec66d15d543b30c8f45b87"
      },
      "msg": "OK"
  }
  ```


- 使用示例

```shell
curl 'http://datumtechs.com/api/v2/data/uploadData' \
     -H 'Accept: application/json, text/plain, */*' \
     -H 'Accept-Language: zh-CN,zh;q=0.9' \
     -H 'Connection: keep-alive' \
     -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryml6aYqp5NPR1V6C9' \
     -H 'Origin: http://datum.io' \
     --data-raw $'------WebKitFormBoundaryml6aYqp5NPR1V6C9\r\nContent-Disposition: form-data; name="file"; filename="服务清单.xlsx"\r\nContent-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\r\n\r   \n\r\n------WebKitFormBoundaryml6aYqp5NPR1V6C9\r\nContent-Disposition: form-data; name="storageType"\r\n\r\n1\r\n------WebKitFormBoundaryml6aYqp5NPR1V6C9\r\nContent-Disposition: form-data;name="storageOption"\r\n\r\n"{\\"cloudType\\": 0}"\r\n------WebKitFormBoundaryml6aYqp5NPR1V6C9--\r\n' \
     --compressed \
     --insecure
```



### IPFS传输

Datum对接分布式存储服务，用户可选择将原始数据传输至IPFS实现分布式管理。数据经由Datum提供的服务传输到IPFS后，用户就能通过Datum提供的后续服务，轻松将数据接入Web3生态。


#### 如何使用


- 接口名称：`uploadData`

- 请求方式: `POST`

- 请求数据类型: `multipart/form-data`

- 响应数据类型: `*/*`


- 请求参数：


|名称|类型|说明|是否必填|
|---|---|---|---|
|file|string|文件|Y| 
|storageType|int|存储方式(0： 本地存储； 1： 云存储； <span style="color: red; font-weight: bold;">2： IPFS存储【本接口填2】；</span> 3： 区块链存储)|Y|
|storageOption|string|json格式的字符串表示存储方式的选项，和storageType搭配使用[查看](#storageOption值说明)|Y|


- 响应状态:


|状态码| 说明 |
|---|---|
|200|OK|
|201|Created|
|401|Unauthorized|
|403|Forbidden|
|404|Not Found|


- 响应参数:


|名称|类型|说明|是否必填|
|---|---|---|---|
|status|int|响应码|Y|
|result|json|上传后的摘要信息|Y|
|originId|string|上传后的原始数据的originId,代表该原始数据在Datum中的唯一标识|Y|
|hash|string|上传后的原始数据内容Hash|Y|
|msg|string|响应描述|Y|



- 响应示例:

  ```json
  {
      "status": 200,
      "result": {
        "originId": "0xdadad...454545",
        "hash": "295e5ae656d084dfda86c4ef7c38719ee1fb650899ec66d15d543b30c8f45b87"
      },
      "msg": "OK"
  }
  ```


- 使用示例

```shell
curl 'http://datumtechs.com/api/v2/data/uploadData' \
     -H 'Accept: application/json, text/plain, */*' \
     -H 'Accept-Language: zh-CN,zh;q=0.9' \
     -H 'Connection: keep-alive' \
     -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryml6aYqp5NPR1V6C9' \
     -H 'Origin: http://datum.io' \
     --data-raw $'------WebKitFormBoundaryml6aYqp5NPR1V6C9\r\nContent-Disposition: form-data; name="file"; filename="服务清单.xlsx"\r\nContent-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\r\n\r   \n\r\n------WebKitFormBoundaryml6aYqp5NPR1V6C9\r\nContent-Disposition: form-data; name="storageType"\r\n\r\n2\r\n------WebKitFormBoundaryml6aYqp5NPR1V6C9\r\nContent-Disposition: form-data;name="storageOption"\r\n\r\n""\r\n------WebKitFormBoundaryml6aYqp5NPR1V6C9--\r\n' \
     --compressed \
     --insecure
```





### 区块链传输

Datum提供联盟链、公有链对接服务，用户可将原始数据直接传输上链。 区块链支持，以太坊、PlatON等。用户可选择是传输原始数据信息，或者传输原始数据hash+原始数据存储索引。


#### 如何使用


- 接口名称：`uploadData`

- 请求方式: `POST`

- 请求数据类型: `multipart/form-data`

- 响应数据类型: `*/*`


- 请求参数：


|名称|类型|说明|是否必填|
|---|---|---|---|
|file|string|文件|Y| 
|storageType|int|存储方式(0： 本地存储； 1： 云存储； 2： IPFS存储； <span style="color: red; font-weight: bold;">3： 区块链存储【本接口填3】</span>)|Y|
|storageOption|string|json格式的字符串表示存储方式的选项，和storageType搭配使用[查看](#storageOption值说明)|Y|


- 响应状态:


|状态码| 说明 |
|---|---|
|200|OK|
|201|Created|
|401|Unauthorized|
|403|Forbidden|
|404|Not Found|


- 响应参数:


|名称|类型|说明|是否必填|
|---|---|---|---|
|status|int|响应码|Y|
|result|json|上传后的摘要信息|Y|
|originId|string|上传后的原始数据的originId,代表该原始数据在Datum中的唯一标识|Y|
|hash|string|上传后的原始数据内容Hash|Y|
|msg|string|响应描述|Y|



- 响应示例:

  ```json
  {
      "status": 200,
      "result": {
        "originId": "0xdadad...454545",
        "hash": "295e5ae656d084dfda86c4ef7c38719ee1fb650899ec66d15d543b30c8f45b87"
      },
      "msg": "OK"
  }
  ```


- 使用示例

```shell
curl 'http://datumtechs.com/api/v2/data/uploadData' \
     -H 'Accept: application/json, text/plain, */*' \
     -H 'Accept-Language: zh-CN,zh;q=0.9' \
     -H 'Connection: keep-alive' \
     -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryml6aYqp5NPR1V6C9' \
     -H 'Origin: http://datum.io' \
     --data-raw $'------WebKitFormBoundaryml6aYqp5NPR1V6C9\r\nContent-Disposition: form-data; name="file"; filename="服务清单.xlsx"\r\nContent-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\r\n\r   \n\r\n------WebKitFormBoundaryml6aYqp5NPR1V6C9\r\nContent-Disposition: form-data; name="storageType"\r\n\r\n3\r\n------WebKitFormBoundaryml6aYqp5NPR1V6C9\r\nContent-Disposition: form-data;name="storageOption"\r\n\r\n"{\\"chainType\\": 1}"\r\n------WebKitFormBoundaryml6aYqp5NPR1V6C9--\r\n' \
     --compressed \
     --insecure
```



## 完成数据发布

在原始数据传输完成后，用户希望通过Datum托管在云服务、IPFS服务上的原始数据能被web3生态应用方检索到，但不暴露所有原始数据信息，那就需要进行元数据发布。



### 提取元数据


元数据是指有关原始数据的一些特征描述信息，例如：原始数据的大小、文件类型、数据场景等。Datum将会对用户上传到云服务、IPFS服务的原始数据提供元数据提取服务，自动提取关键数据特征，打包成待发布的元数据，用户也可以对自动提取的元数据进行修改、增加描述信息。


#### 如何使用


- 接口名称：`queryLocalMetadata`

- 请求方式: `GET`

- 请求数据类型: 无

- 响应数据类型: `*/*`


- 请求参数：


|名称|类型|说明|是否必填|
|---|---|---|---|
|originId|string|用户将原始数据托管到Datum时返回的originId (即： 原始数据在Datum中的唯一标识)|Y| 



- 响应状态:


|状态码| 说明 |
|---|---|
|200|OK|
|201|Created|
|401|Unauthorized|
|403|Forbidden|
|404|Not Found|


- 响应参数:


|名称|类型|说明|是否必填|
|---|---|---|---|
|status|int|响应码|Y|
|result|json|原始数据对应的未发布元数据信息|Y|
|msg|string|响应描述|Y|



- 响应示例:

```json
{
      "status": 200,
      "result": {
            "owner": {
                "nodeName": "new_org152",
                "nodeId": "3188983b115ee29a09fc4798e4944cbb82636bd202d4d4611bde1cc347c7790c62186e91d55584b62c967f7466db97211238f81da52aa3db94d203e1d30043bb",
                "identityId": "did:pid:lat18vpuxh97dh52y6kr5csacuj9qv2c7qaem5ax8d",
                "identityType": 0,
                "dataStatus": 0,
                "status": 0,
                "updateAt": "0",
                "imageUrl": "",
                "details": "",
                "credential": "",
                "nonce": "0"
            },
            "information": {
                    "metadataId": "metadata:0x2cbb932fe93b84140d388501f399bbbe5825f473a9f13c437ac292c2b3693646",
                    "metadataName": "bank_predict_partyA",
                    "metadataType": 1,
                    "dataHash": "295e5ae656d084dfda86c4ef7c38719ee1fb650899ec66d15d543b30c8f45b87",
                    "desc": "bank_predict_partyA",
                    "locationType": 1,
                    "dataType": 1,
                    "industry": "1",
                    "state": 2,
                    "publishAt": "1660803893000",
                    "updateAt": "1660803893000",
                    "nonce": "5",
                    "metadataOption": "{\"metadataColumns\":[{\"index\":1,\"type\":\"string\",\"size\":0,\"name\":\"CLIENT_ID\"},{\"index\":2,\"type\":\"string\",\"size\":0,\"name\":\"DEFAULT\"},{\"index\":3,\"type\":\"string\",\"size\":0,\"name\":\"HOUSING\"},{\"index\":4,\"type\":\"string\",\"size\":0,\"name\":\"LOAN\"},{\"index\":5,\"type\":\"string\",\"size\":0,\"name\":\"CONTACT\"},{\"index\":6,\"type\":\"string\",\"size\":0,\"name\":\"CAMPAIGN\"},{\"index\":7,\"type\":\"string\",\"size\":0,\"name\":\"PDAYS\"},{\"index\":8,\"type\":\"string\",\"size\":0,\"name\":\"PREVIOUS\"},{\"index\":9,\"type\":\"string\",\"size\":0,\"name\":\"EURIBOR3M\"},{\"index\":10,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_APR\"},{\"index\":11,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_AUG\"},{\"index\":12,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_DEC\"},{\"index\":13,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_JUL\"},{\"index\":14,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_JUN\"},{\"index\":15,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_MAR\"},{\"index\":16,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_MAY\"},{\"index\":17,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_NOV\"},{\"index\":18,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_OCT\"},{\"index\":19,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_SEP\"},{\"index\":20,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_FRI\"},{\"index\":21,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_MON\"},{\"index\":22,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_THU\"},{\"index\":23,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_TUE\"},{\"index\":24,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_WED\"},{\"index\":25,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_FAILURE\"},{\"index\":26,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_NONEXISTENT\"},{\"index\":27,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_SUCCESS\"}],\"columns\":27,\"rows\":7925,\"consumeOptions\":[],\"dataPath\":\"/home/user1/data/data_root/bank_predict_partyA_20220818-062409.csv\",\"condition\":3,\"originId\":\"07ac869b639a4a810caa3d23cc1a3872109b0258f8da9ff13046f9fbee048c21\",\"size\":609112,\"consumeTypes\":[],\"hasTitle\":true}",
                    "user": "0x7e336d121679e9d741ab771992d5f32286f60d4a",
                    "userType": 1,
                    "sign": ""
            }
        },
      "msg": "OK"
}
```


- 使用示例

```shell
curl --location --request GET 'http://datumtechs.com/api/v2/metadata/queryLocalMetadata?originId=0xdadad...454545'
```




### 发布元数据


发布元数据是指将元数据发布到区块链网络，或者指定的数据服务市场，能够被其他应用方检索发现，并达成后续应用。元数据发布按照原始数据存储路径可以分为：（a）通过Datum传输渠道存储的原始数据发布元数据；（b）基于用户本地存储的原始数据发布元数据。


#### **（a）通过Datum传输渠道存储的原始数据发布元数据**

Datum提供的云服务、IPFS服务会对用户传输的原始数据自动提取打包待发布元数据，用户修改确认元数据包含的特征及描述后，可以提交发布。用户可以选择将元数据发布至区块链网络，或者指定的数据服务市场。


#### 如何使用


- 接口名称：`publishMetadata`

- 请求方式: `POST`

- 请求数据类型: `application/json`

- 响应数据类型: `*/*`


- 请求参数：


|名称|类型|说明|是否必填|
|---|---|---|---|
|metadataId|string|元数据Id|Y| 
|metadataName|string|元数据名称|Y|
|metadataType|int|元数据类型|Y|
|dataHash|string|原始数据内容Hash|Y|
|desc|string|数据描述|N|
|locationType|int|原始数据存储的方式|Y|
|dataType|int|原始数据的类型|Y|
|industry|string|数据适用行业|Y|
|state|int|元数据状态|Y|
|metadataOption|stirng|元数据的选项信息json字符串|Y|
|user|string|用户信息|Y|
|userType|int|用户类型|Y|
|sign|string|元数据的消息签名|Y|


- 请求参数示例：

```json
{
      "metadataId": "metadata:0x2cbb932fe93b84140d388501f399bbbe5825f473a9f13c437ac292c2b3693646",
      "metadataName": "bank_predict_partyA",
      "metadataType": 1,
      "dataHash": "295e5ae656d084dfda86c4ef7c38719ee1fb650899ec66d15d543b30c8f45b87",
      "desc": "bank_predict_partyA",
      "locationType": 1,
      "dataType": 1,
      "industry": "1",
      "state": 2,
      "metadataOption": "{\"metadataColumns\":[{\"index\":1,\"type\":\"string\",\"size\":0,\"name\":\"CLIENT_ID\"},{\"index\":2,\"type\":\"string\",\"size\":0,\"name\":\"DEFAULT\"},{\"index\":3,\"type\":\"string\",\"size\":0,\"name\":\"HOUSING\"},{\"index\":4,\"type\":\"string\",\"size\":0,\"name\":\"LOAN\"},{\"index\":5,\"type\":\"string\",\"size\":0,\"name\":\"CONTACT\"},{\"index\":6,\"type\":\"string\",\"size\":0,\"name\":\"CAMPAIGN\"},{\"index\":7,\"type\":\"string\",\"size\":0,\"name\":\"PDAYS\"},{\"index\":8,\"type\":\"string\",\"size\":0,\"name\":\"PREVIOUS\"},{\"index\":9,\"type\":\"string\",\"size\":0,\"name\":\"EURIBOR3M\"},{\"index\":10,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_APR\"},{\"index\":11,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_AUG\"},{\"index\":12,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_DEC\"},{\"index\":13,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_JUL\"},{\"index\":14,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_JUN\"},{\"index\":15,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_MAR\"},{\"index\":16,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_MAY\"},{\"index\":17,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_NOV\"},{\"index\":18,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_OCT\"},{\"index\":19,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_SEP\"},{\"index\":20,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_FRI\"},{\"index\":21,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_MON\"},{\"index\":22,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_THU\"},{\"index\":23,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_TUE\"},{\"index\":24,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_WED\"},{\"index\":25,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_FAILURE\"},{\"index\":26,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_NONEXISTENT\"},{\"index\":27,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_SUCCESS\"}],\"columns\":27,\"rows\":7925,\"consumeOptions\":[],\"dataPath\":\"/home/user1/data/data_root/bank_predict_partyA_20220818-062409.csv\",\"condition\":3,\"originId\":\"07ac869b639a4a810caa3d23cc1a3872109b0258f8da9ff13046f9fbee048c21\",\"size\":609112,\"consumeTypes\":[],\"hasTitle\":true}",
      "user": "0x7e336d121679e9d741ab771992d5f32286f60d4a",
      "userType": 1,
      "sign": "77+9UCNp77+9QFhC77+977+9Ru+/ve+/vUhGEe+/ve+/ve+/ve+/vQbvv73vv70dfu+/vd+Ff++/vTXvv73vv71w77+977+93KTvv73vv70F77+9Nu+/vWhjbEXvv73vv73vv73vv71Z77+977+977+977+9Yu+/ve+/vQ3vv70c"
}
```



- 响应状态:


|状态码| 说明 |
|---|---|
|200|OK|
|201|Created|
|401|Unauthorized|
|403|Forbidden|
|404|Not Found|


- 响应参数:


|名称|类型|说明|是否必填|
|---|---|---|---|
|status|int|响应码|Y|
|result|json|返回信息|Y|
|originId|string|上传后的原始数据的originId,代表该原始数据在Datum中的唯一标识|Y|
|metadataId|string|发布后的元数据Id|Y|
|msg|string|响应描述|Y|



- 响应示例:

```json
{
      "status": 200,
      "result": {
        "originId": "0xdadad...454545",
        "metadataId": "metadata:0x2cbb932fe93b84140d388501f399bbbe5825f473a9f13c437ac292c2b3693646"
      },
      "msg": "OK"
}
```


- 使用示例

```shell
curl --location --request POST 'http://datumtechs.com/api/v2/metadat/publishMetadata' \
--header 'Content-Type: application/json' \
--data-raw '{
      "metadataId": "metadata:0x2cbb932fe93b84140d388501f399bbbe5825f473a9f13c437ac292c2b3693646",
      "metadataName": "bank_predict_partyA",
      "metadataType": 1,
      "dataHash": "295e5ae656d084dfda86c4ef7c38719ee1fb650899ec66d15d543b30c8f45b87",
      "desc": "bank_predict_partyA",
      "locationType": 1,
      "dataType": 1,
      "industry": "1",
      "state": 2,
      "metadataOption": "{\"metadataColumns\":[{\"index\":1,\"type\":\"string\",\"size\":0,\"name\":\"CLIENT_ID\"},{\"index\":2,\"type\":\"string\",\"size\":0,\"name\":\"DEFAULT\"},{\"index\":3,\"type\":\"string\",\"size\":0,\"name\":\"HOUSING\"},{\"index\":4,\"type\":\"string\",\"size\":0,\"name\":\"LOAN\"},{\"index\":5,\"type\":\"string\",\"size\":0,\"name\":\"CONTACT\"},{\"index\":6,\"type\":\"string\",\"size\":0,\"name\":\"CAMPAIGN\"},{\"index\":7,\"type\":\"string\",\"size\":0,\"name\":\"PDAYS\"},{\"index\":8,\"type\":\"string\",\"size\":0,\"name\":\"PREVIOUS\"},{\"index\":9,\"type\":\"string\",\"size\":0,\"name\":\"EURIBOR3M\"},{\"index\":10,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_APR\"},{\"index\":11,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_AUG\"},{\"index\":12,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_DEC\"},{\"index\":13,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_JUL\"},{\"index\":14,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_JUN\"},{\"index\":15,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_MAR\"},{\"index\":16,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_MAY\"},{\"index\":17,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_NOV\"},{\"index\":18,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_OCT\"},{\"index\":19,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_SEP\"},{\"index\":20,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_FRI\"},{\"index\":21,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_MON\"},{\"index\":22,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_THU\"},{\"index\":23,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_TUE\"},{\"index\":24,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_WED\"},{\"index\":25,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_FAILURE\"},{\"index\":26,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_NONEXISTENT\"},{\"index\":27,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_SUCCESS\"}],\"columns\":27,\"rows\":7925,\"consumeOptions\":[],\"dataPath\":\"/home/user1/data/data_root/bank_predict_partyA_20220818-062409.csv\",\"condition\":3,\"originId\":\"07ac869b639a4a810caa3d23cc1a3872109b0258f8da9ff13046f9fbee048c21\",\"size\":609112,\"consumeTypes\":[],\"hasTitle\":true}",
      "user": "0x7e336d121679e9d741ab771992d5f32286f60d4a",
      "userType": 1,
      "sign": "77+9UCNp77+9QFhC77+977+9Ru+/ve+/vUhGEe+/ve+/ve+/ve+/vQbvv73vv70dfu+/vd+Ff++/vTXvv73vv71w77+977+93KTvv73vv70F77+9Nu+/vWhjbEXvv73vv73vv73vv71Z77+977+977+977+9Yu+/ve+/vQ3vv70c"
}'
```






#### **（b）基于用户本地存储的原始数据发布元数据**

除Datum提供的数据传输渠道外，用户能基于Datum提供的服务，引用存储在本地的原始数据，完成元数据发布。用户可以选择将元数据发布至区块链网络，或者指定的数据服务市场。


#### 如何使用


- 接口名称：`publishMetadataWithLocalDdata`

- 请求方式: `POST`

- 请求数据类型: `application/json`

- 响应数据类型: `*/*`


- 请求参数：


|名称|类型|说明|是否必填|
|---|---|---|---|
|metadataId|string|元数据Id|Y| 
|metadataName|string|元数据名称|Y|
|metadataType|int|元数据类型|Y|
|dataHash|string|原始数据内容Hash|Y|
|desc|string|数据描述|N|
|locationType|int|原始数据存储的方式|Y|
|dataType|int|原始数据的类型|Y|
|industry|string|数据适用行业|Y|
|state|int|元数据状态|Y|
|metadataOption|stirng|元数据的选项信息json字符串|Y|
|user|string|用户信息|Y|
|userType|int|用户类型|Y|
|sign|string|元数据的消息签名|Y|


- 请求参数示例：

```json
{
      "metadataId": "metadata:0x2cbb932fe93b84140d388501f399bbbe5825f473a9f13c437ac292c2b3693646",
      "metadataName": "bank_predict_partyA",
      "metadataType": 1,
      "dataHash": "295e5ae656d084dfda86c4ef7c38719ee1fb650899ec66d15d543b30c8f45b87",
      "desc": "bank_predict_partyA",
      "locationType": 1,
      "dataType": 1,
      "industry": "1",
      "state": 2,
      "metadataOption": "{\"metadataColumns\":[{\"index\":1,\"type\":\"string\",\"size\":0,\"name\":\"CLIENT_ID\"},{\"index\":2,\"type\":\"string\",\"size\":0,\"name\":\"DEFAULT\"},{\"index\":3,\"type\":\"string\",\"size\":0,\"name\":\"HOUSING\"},{\"index\":4,\"type\":\"string\",\"size\":0,\"name\":\"LOAN\"},{\"index\":5,\"type\":\"string\",\"size\":0,\"name\":\"CONTACT\"},{\"index\":6,\"type\":\"string\",\"size\":0,\"name\":\"CAMPAIGN\"},{\"index\":7,\"type\":\"string\",\"size\":0,\"name\":\"PDAYS\"},{\"index\":8,\"type\":\"string\",\"size\":0,\"name\":\"PREVIOUS\"},{\"index\":9,\"type\":\"string\",\"size\":0,\"name\":\"EURIBOR3M\"},{\"index\":10,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_APR\"},{\"index\":11,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_AUG\"},{\"index\":12,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_DEC\"},{\"index\":13,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_JUL\"},{\"index\":14,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_JUN\"},{\"index\":15,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_MAR\"},{\"index\":16,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_MAY\"},{\"index\":17,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_NOV\"},{\"index\":18,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_OCT\"},{\"index\":19,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_SEP\"},{\"index\":20,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_FRI\"},{\"index\":21,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_MON\"},{\"index\":22,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_THU\"},{\"index\":23,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_TUE\"},{\"index\":24,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_WED\"},{\"index\":25,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_FAILURE\"},{\"index\":26,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_NONEXISTENT\"},{\"index\":27,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_SUCCESS\"}],\"columns\":27,\"rows\":7925,\"consumeOptions\":[],\"dataPath\":\"/home/user1/data/data_root/bank_predict_partyA_20220818-062409.csv\",\"condition\":3,\"originId\":\"07ac869b639a4a810caa3d23cc1a3872109b0258f8da9ff13046f9fbee048c21\",\"size\":609112,\"consumeTypes\":[],\"hasTitle\":true}",
      "user": "0x7e336d121679e9d741ab771992d5f32286f60d4a",
      "userType": 1,
      "sign": "77+9UCNp77+9QFhC77+977+9Ru+/ve+/vUhGEe+/ve+/ve+/ve+/vQbvv73vv70dfu+/vd+Ff++/vTXvv73vv71w77+977+93KTvv73vv70F77+9Nu+/vWhjbEXvv73vv73vv73vv71Z77+977+977+977+9Yu+/ve+/vQ3vv70c"
}
```



- 响应状态:


|状态码| 说明 |
|---|---|
|200|OK|
|201|Created|
|401|Unauthorized|
|403|Forbidden|
|404|Not Found|


- 响应参数:


|名称|类型|说明|是否必填|
|---|---|---|---|
|status|int|响应码|Y|
|result|json|返回信息|Y|
|originId|string|上传后的原始数据的originId,代表该原始数据在Datum中的唯一标识|Y|
|metadataId|string|发布后的元数据Id|Y|
|msg|string|响应描述|Y|



- 响应示例:

```json
{
      "status": 200,
      "result": {
        "originId": "0xdadad...454545",
        "metadataId": "metadata:0x2cbb932fe93b84140d388501f399bbbe5825f473a9f13c437ac292c2b3693646"
      },
      "msg": "OK"
}
```


- 使用示例

```shell
curl --location --request POST 'http://datumtechs.com/api/v2/metadat/publishMetadataWithLocalDdata' \
--header 'Content-Type: application/json' \
--data-raw '{
      "metadataId": "metadata:0x2cbb932fe93b84140d388501f399bbbe5825f473a9f13c437ac292c2b3693646",
      "metadataName": "bank_predict_partyA",
      "metadataType": 1,
      "dataHash": "295e5ae656d084dfda86c4ef7c38719ee1fb650899ec66d15d543b30c8f45b87",
      "desc": "bank_predict_partyA",
      "locationType": 1,
      "dataType": 1,
      "industry": "1",
      "state": 2,
      "metadataOption": "{\"metadataColumns\":[{\"index\":1,\"type\":\"string\",\"size\":0,\"name\":\"CLIENT_ID\"},{\"index\":2,\"type\":\"string\",\"size\":0,\"name\":\"DEFAULT\"},{\"index\":3,\"type\":\"string\",\"size\":0,\"name\":\"HOUSING\"},{\"index\":4,\"type\":\"string\",\"size\":0,\"name\":\"LOAN\"},{\"index\":5,\"type\":\"string\",\"size\":0,\"name\":\"CONTACT\"},{\"index\":6,\"type\":\"string\",\"size\":0,\"name\":\"CAMPAIGN\"},{\"index\":7,\"type\":\"string\",\"size\":0,\"name\":\"PDAYS\"},{\"index\":8,\"type\":\"string\",\"size\":0,\"name\":\"PREVIOUS\"},{\"index\":9,\"type\":\"string\",\"size\":0,\"name\":\"EURIBOR3M\"},{\"index\":10,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_APR\"},{\"index\":11,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_AUG\"},{\"index\":12,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_DEC\"},{\"index\":13,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_JUL\"},{\"index\":14,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_JUN\"},{\"index\":15,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_MAR\"},{\"index\":16,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_MAY\"},{\"index\":17,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_NOV\"},{\"index\":18,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_OCT\"},{\"index\":19,\"type\":\"string\",\"size\":0,\"name\":\"MONTH_SEP\"},{\"index\":20,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_FRI\"},{\"index\":21,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_MON\"},{\"index\":22,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_THU\"},{\"index\":23,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_TUE\"},{\"index\":24,\"type\":\"string\",\"size\":0,\"name\":\"DAY_OF_WEEK_WED\"},{\"index\":25,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_FAILURE\"},{\"index\":26,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_NONEXISTENT\"},{\"index\":27,\"type\":\"string\",\"size\":0,\"name\":\"POUTCOME_SUCCESS\"}],\"columns\":27,\"rows\":7925,\"consumeOptions\":[],\"dataPath\":\"/home/user1/data/data_root/bank_predict_partyA_20220818-062409.csv\",\"condition\":3,\"originId\":\"07ac869b639a4a810caa3d23cc1a3872109b0258f8da9ff13046f9fbee048c21\",\"size\":609112,\"consumeTypes\":[],\"hasTitle\":true}",
      "user": "0x7e336d121679e9d741ab771992d5f32286f60d4a",
      "userType": 1,
      "sign": "77+9UCNp77+9QFhC77+977+9Ru+/ve+/vUhGEe+/ve+/ve+/ve+/vQbvv73vv70dfu+/vd+Ff++/vTXvv73vv71w77+977+93KTvv73vv70F77+9Nu+/vWhjbEXvv73vv73vv73vv71Z77+977+977+977+9Yu+/ve+/vQ3vv70c"
}'
```




### 发布数据Hash

在某些场景下，用户出于业务需求需要发布原始数据Hash到区块链网络或者数据服务平台。



#### 如何使用


- 接口名称：`publishDataHash`

- 请求方式: `POST`

- 请求数据类型: `application/json`

- 响应数据类型: `*/*`


- 请求参数：


|名称|类型|说明|是否必填|
|---|---|---|---|
|dataHash|string|原始数据内容Hash|Y|
|desc|string|数据描述|N|
|user|string|用户信息|Y|
|userType|int|用户类型|Y|
|sign|string|元数据的消息签名|Y|


- 请求参数示例：

```json
{
      "dataHash": "295e5ae656d084dfda86c4ef7c38719ee1fb650899ec66d15d543b30c8f45b87",
      "desc": "bank_predict_partyA",
      "user": "0x7e336d121679e9d741ab771992d5f32286f60d4a",
      "userType": 1,
      "sign": "77+9UCNp77+9QFhC77+977+9Ru+/ve+/vUhGEe+/ve+/ve+/ve+/vQbvv73vv70dfu+/vd+Ff++/vTXvv73vv71w77+977+93KTvv73vv70F77+9Nu+/vWhjbEXvv73vv73vv73vv71Z77+977+977+977+9Yu+/ve+/vQ3vv70c"
}
```



- 响应状态:


|状态码| 说明 |
|---|---|
|200|OK|
|201|Created|
|401|Unauthorized|
|403|Forbidden|
|404|Not Found|


- 响应参数:


|名称|类型|说明|是否必填|
|---|---|---|---|
|status|int|响应码|Y|
|result|json|返回信息|Y|
|msg|string|响应描述|Y|



- 响应示例:

```json
{
      "status": 200,
      "result": "",
      "msg": "OK"
}
```


- 使用示例

```shell
curl --location --request POST 'http://datumtechs.com/api/v2/metadat/publishDataHash' \
--header 'Content-Type: application/json' \
--data-raw '{
      "dataHash": "295e5ae656d084dfda86c4ef7c38719ee1fb650899ec66d15d543b30c8f45b87",
      "desc": "bank_predict_partyA",
      "user": "0x7e336d121679e9d741ab771992d5f32286f60d4a",
      "userType": 1,
      "sign": "77+9UCNp77+9QFhC77+977+9Ru+/ve+/vUhGEe+/ve+/ve+/ve+/vQbvv73vv70dfu+/vd+Ff++/vTXvv73vv71w77+977+93KTvv73vv70F77+9Nu+/vWhjbEXvv73vv73vv73vv71Z77+977+977+977+9Yu+/ve+/vQ3vv70c"
}'
```




### 补充说明

#### <span id="storageOption值说明"> storageOption值说明： </span>



- storageType： 0

- storageOption：

```
""
```


- storageType： 1

- storageOption：

```
"{
    "cloudType": 0    // 0: 使用Datum默认的方式存储； 1: 使用Datum提供的阿里云存储； 2: 使用Datum提供的腾讯云存储；...
  }"
```




- storageType： 2

- storageOption：

```
""
```


- storageType： 3

- storageOption：

```
"{
    "chainType": 0 // 0: 使用Alaya存储； 1: 使用PlatON存储； 2: 使用Etheruem存储； （待补充）...
  }"
```



